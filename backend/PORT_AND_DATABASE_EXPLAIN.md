# 端口号与数据库的关系详解

## 一、端口号是什么？

### 端口号 = 服务的"门牌号"

**简单理解**：

- 您的电脑就像一栋大楼
- **端口号**就像大楼里的**房间号**
- 不同的服务运行在不同的"房间"（端口）里

### 实际例子

```
您的电脑（IP: localhost）
├── 端口 3000  → NestJS 后端服务
├── 端口 5173  → Vue 前端开发服务器
├── 端口 3306  → MySQL 数据库服务 ⭐
└── 端口 8080  → 其他服务（如果有）
```

---

## 二、3306 端口代表什么？

### 3306 = MySQL 服务的监听端口

**重要理解**：

- **3306 不是数据库**，而是 **MySQL 服务**运行的端口
- 一个 MySQL 服务可以包含**多个数据库**
- 就像一个"数据库服务器"可以管理多个"数据库"

### 类比理解

```
端口 3306 = MySQL 服务（整个数据库服务器）
    ├── information_schema（系统数据库）
    ├── mysql（系统数据库）
    ├── performance_schema（系统数据库）
    ├── sys（系统数据库）
    └── todo_db（您的项目数据库）⭐
```

**就像**：

- 一个图书馆（MySQL 服务，端口 3306）
- 里面有多个书架（多个数据库）
- 每个书架放不同的书（不同的数据）

---

## 三、MySQL 服务 vs 数据库

### MySQL 服务（端口 3306）

- **是什么**：一个运行在您电脑上的**程序/服务**
- **作用**：管理所有数据库，处理数据库请求
- **端口**：默认 3306（可以修改）

### 数据库（如 todo_db）

- **是什么**：MySQL 服务管理的**数据容器**
- **作用**：存储具体的业务数据
- **位置**：在 MySQL 服务内部

### 关系图

```
┌─────────────────────────────────────┐
│  MySQL 服务（运行在端口 3306）        │
│  ┌───────────────────────────────┐  │
│  │ 系统数据库（MySQL 自带）        │  │
│  │ - information_schema          │  │
│  │ - mysql                       │  │
│  │ - performance_schema          │  │
│  │ - sys                         │  │
│  └───────────────────────────────┘  │
│  ┌───────────────────────────────┐  │
│  │ 业务数据库（您创建的）          │  │
│  │ - todo_db ⭐                  │  │
│  │ - 其他项目数据库（如果有）      │  │
│  └───────────────────────────────┘  │
└─────────────────────────────────────┘
```

---

## 四、为什么会有多个数据库？

### 系统数据库（MySQL 自带）

当您安装 MySQL 时，它会自动创建 4 个系统数据库：

1. **`information_schema`** - 存储数据库结构信息
2. **`mysql`** - 存储用户、权限信息
3. **`performance_schema`** - 性能监控数据
4. **`sys`** - 系统视图和存储过程

**这些是 MySQL 运行必需的**，就像操作系统的系统文件一样。

### 业务数据库（您创建的）

- **`todo_db`** - 您为 Todo List 项目创建的数据库
- 您可以创建更多数据库，比如：
  - `user_db` - 用户管理项目
  - `shop_db` - 电商项目
  - 等等

---

## 五、换台电脑的情况

### 场景：换台电脑，MySQL 运行在 3307 端口

**答案**：是的，您仍然会看到那 4 个系统数据库！

### 原因

1. **系统数据库是 MySQL 自带的**
   - 无论在哪台电脑，安装 MySQL 都会自动创建这 4 个系统数据库
   - 它们不是您创建的，是 MySQL 软件自带的

2. **端口号只是服务的"门牌号"**
   - 3306 或 3307 只是 MySQL 服务运行的端口
   - 端口不同，但 MySQL 服务的内容是一样的

### 对比

| 项目           | 当前电脑（3306）    | 新电脑（3307）     |
| -------------- | ------------------- | ------------------ |
| MySQL 服务端口 | 3306                | 3307               |
| 系统数据库     | 4 个（自动创建）    | 4 个（自动创建）   |
| 业务数据库     | todo_db（您创建的） | 需要重新创建或导入 |

### 重要区别

- **系统数据库**：每台电脑的 MySQL 都有，自动存在
- **业务数据库**：需要您创建或从其他电脑导入

---

## 六、实际例子

### 当前情况

```bash
# 连接到端口 3306 的 MySQL 服务
mysql -u root -h localhost -P 3306

# 看到的数据库：
information_schema  ← MySQL 自带
mysql               ← MySQL 自带
performance_schema  ← MySQL 自带
sys                 ← MySQL 自带
todo_db             ← 您创建的 ⭐
```

### 如果换到新电脑

```bash
# 连接到端口 3307 的 MySQL 服务
mysql -u root -h localhost -P 3307

# 看到的数据库：
information_schema  ← MySQL 自带（自动存在）
mysql               ← MySQL 自带（自动存在）
performance_schema  ← MySQL 自带（自动存在）
sys                 ← MySQL 自带（自动存在）
# todo_db           ← 不存在！需要重新创建或导入
```

---

## 七、端口号可以修改吗？

### 可以修改，但不推荐

MySQL 的端口号可以在配置文件中修改：

```bash
# MySQL 配置文件位置（macOS）
/opt/homebrew/etc/my.cnf

# 修改端口
[mysqld]
port = 3307  # 改为 3307
```

### 修改后的影响

- 如果改为 3307，您的项目配置也需要修改：
  ```typescript
  // backend/src/app.module.ts
  port: 3307,  // 改为 3307
  ```

### 为什么默认是 3306？

- MySQL 官方规定的默认端口
- 3306 是 MySQL 的标准端口
- 大多数情况下不需要修改

---

## 八、总结

### 核心概念

1. **端口号（3306）** = MySQL 服务运行的"门牌号"
2. **MySQL 服务** = 管理所有数据库的程序
3. **数据库** = MySQL 服务内部的数据容器

### 关系

```
端口 3306
  └── MySQL 服务
      ├── 系统数据库（4个，MySQL 自带）
      └── 业务数据库（您创建的，如 todo_db）
```

### 换电脑的情况

- ✅ **系统数据库**：自动存在（MySQL 自带）
- ❌ **业务数据库**：需要重新创建或导入

### 类比

- **端口 3306** = 图书馆的地址
- **MySQL 服务** = 整个图书馆
- **系统数据库** = 图书馆的管理系统（自动存在）
- **todo_db** = 您存放 Todo 数据的书架（需要创建）

---

## 九、常见问题

### Q1: 我可以删除系统数据库吗？

**A**: ❌ **不可以！** 系统数据库是 MySQL 运行必需的，删除会导致 MySQL 无法正常工作。

### Q2: 为什么我连接 3306 看到 5 个数据库？

**A**: 4 个是 MySQL 自带的系统数据库，1 个（todo_db）是您创建的业务数据库。

### Q3: 换电脑后，todo_db 还在吗？

**A**: ❌ **不在**。业务数据库需要从旧电脑导出，然后在新电脑导入。

### Q4: 端口号可以改成其他数字吗？

**A**: ✅ **可以**，但不推荐。3306 是 MySQL 的标准端口。

### Q5: 一个 MySQL 服务可以有多少个数据库？

**A**: 理论上**无限制**，但实际受磁盘空间和性能限制。

---

## 十、查看当前 MySQL 端口

```bash
# 查看 MySQL 监听的端口
lsof -i :3306

# 或查看 MySQL 配置
mysql -u root -e "SHOW VARIABLES LIKE 'port';"
```

---

希望这个解释能帮您理解端口号和数据库的关系！🎉
